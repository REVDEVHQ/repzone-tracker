<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<title>RepZone Pro</title>
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://sea.refinedpainting.co/js/form_embed.js" type="text/javascript"></script>
<style>
  * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
  html, body { height: 100%; width: 100%; overflow: hidden; font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; }
  #map { height: 100% !important; width: 100% !important; }
  
  .spinner { border: 3px solid #f3f3f3; border-top: 3px solid #3b82f6; border-radius: 50%; width: 30px; height: 30px; animation: spin 1s linear infinite; }
  @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
  @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
  @keyframes slideIn { from { transform: translateX(-400px); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
  @keyframes slideUp { from { transform: translateY(100%); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
  @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
  @keyframes shimmer { 0% { background-position: -1000px 0; } 100% { background-position: 1000px 0; } }
  
  .tracking-indicator { animation: pulse 2s infinite; }
  
  .sidebar {
    width: 420px;
    height: 100vh;
    background: linear-gradient(180deg, #0f172a 0%, #1e293b 100%);
    position: fixed;
    left: 0;
    top: 0;
    overflow-y: auto;
    overflow-x: hidden;
    z-index: 1000;
    box-shadow: 4px 0 24px rgba(0,0,0,0.3);
    transition: transform 0.3s ease;
  }
  
  .sidebar::-webkit-scrollbar { width: 8px; }
  .sidebar::-webkit-scrollbar-track { background: #1e293b; }
  .sidebar::-webkit-scrollbar-thumb { background: #334155; border-radius: 4px; }
  
  .sidebar-content {
    padding: 1.5rem;
  }
  
  .tab-nav {
    display: flex;
    gap: 0.5rem;
    background: rgba(15, 23, 42, 0.5);
    padding: 0.5rem;
    border-radius: 1rem;
    margin-bottom: 1.5rem;
  }
  
  .tab {
    flex: 1;
    padding: 0.75rem;
    text-align: center;
    border-radius: 0.75rem;
    cursor: pointer;
    font-weight: 600;
    font-size: 0.875rem;
    color: #94a3b8;
    transition: all 0.2s;
  }
  
  .tab.active {
    background: #3b82f6;
    color: white;
    box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);
  }
  
  .tab:hover:not(.active) {
    background: rgba(59, 130, 246, 0.1);
    color: #cbd5e1;
  }
  
  .card {
    background: rgba(255, 255, 255, 0.08);
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 1rem;
    padding: 1.25rem;
    margin-bottom: 1rem;
    transition: all 0.2s;
  }
  
  .card:hover {
    background: rgba(255, 255, 255, 0.12);
    transform: translateY(-2px);
  }
  
  .stat-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 0.75rem;
    margin-bottom: 1rem;
  }
  
  .stat-card {
    background: linear-gradient(135deg, rgba(59, 130, 246, 0.1) 0%, rgba(99, 102, 241, 0.1) 100%);
    border: 1px solid rgba(59, 130, 246, 0.2);
    border-radius: 0.875rem;
    padding: 1rem;
    text-align: center;
    transition: all 0.2s;
  }
  
  .stat-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 16px rgba(59, 130, 246, 0.2);
  }
  
  .stat-value {
    font-size: 2rem;
    font-weight: 700;
    color: white;
    line-height: 1;
    margin-bottom: 0.25rem;
  }
  
  .stat-label {
    font-size: 0.75rem;
    color: #94a3b8;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.05em;
  }
  
  .lead-type-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 0.75rem;
    margin-top: 1rem;
  }
  
  .lead-type-btn {
    padding: 1.5rem 1rem;
    border-radius: 0.875rem;
    border: 2px solid transparent;
    cursor: pointer;
    transition: all 0.2s;
    text-align: center;
    font-weight: 600;
  }
  
  .lead-type-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 16px rgba(0,0,0,0.2);
  }
  
  .lead-type-btn.active {
    border-color: white;
    box-shadow: 0 0 0 3px rgba(255,255,255,0.2);
  }
  
  .lead-type-btn .emoji {
    font-size: 2rem;
    display: block;
    margin-bottom: 0.5rem;
  }
  
  .lead-type-btn .label {
    font-size: 0.875rem;
    font-weight: 700;
  }
  
  .btn {
    padding: 0.875rem 1.5rem;
    border-radius: 0.75rem;
    border: none;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
    font-size: 0.9375rem;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
  }
  
  .btn-primary {
    background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
    color: white;
    box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);
  }
  
  .btn-primary:hover {
    box-shadow: 0 6px 20px rgba(59, 130, 246, 0.6);
    transform: translateY(-1px);
  }
  
  .btn-secondary {
    background: rgba(255, 255, 255, 0.1);
    color: white;
    border: 1px solid rgba(255, 255, 255, 0.2);
  }
  
  .btn-secondary:hover {
    background: rgba(255, 255, 255, 0.15);
  }
  
  .input {
    width: 100%;
    padding: 0.875rem 1rem;
    border-radius: 0.75rem;
    border: 1px solid rgba(255, 255, 255, 0.1);
    background: rgba(0, 0, 0, 0.2);
    color: white;
    font-size: 0.9375rem;
    transition: all 0.2s;
  }
  
  .input::placeholder {
    color: #64748b;
  }
  
  .input:focus {
    outline: none;
    border-color: #3b82f6;
    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
  }
  
  .toast {
    position: fixed;
    top: 1.5rem;
    right: 1.5rem;
    background: white;
    padding: 1rem 1.5rem;
    border-radius: 1rem;
    box-shadow: 0 10px 40px rgba(0,0,0,0.2);
    z-index: 10001;
    animation: slideIn 0.3s ease;
    max-width: 400px;
    border-left: 4px solid #3b82f6;
  }
  
  .modal {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.7);
    backdrop-filter: blur(4px);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 10000;
    animation: fadeIn 0.2s;
    padding: 1rem;
  }
  
  .modal-content {
    background: #1e293b;
    border-radius: 1.5rem;
    padding: 2rem;
    max-width: 500px;
    width: 100%;
    max-height: 90vh;
    overflow-y: auto;
    box-shadow: 0 20px 60px rgba(0,0,0,0.5);
    animation: slideUp 0.3s;
  }
  
  .user-badge {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 1rem;
    background: rgba(255, 255, 255, 0.08);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 1rem;
    margin-bottom: 1.5rem;
  }
  
  .user-avatar {
    width: 48px;
    height: 48px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 700;
    font-size: 1.25rem;
    color: white;
  }
  
  .hamburger-btn {
    display: none;
    position: fixed;
    top: 1rem;
    left: 1rem;
    width: 54px;
    height: 54px;
    background: white;
    border: none;
    border-radius: 1rem;
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    cursor: pointer;
    z-index: 1002;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 5px;
  }
  
  .hamburger-btn span {
    width: 26px;
    height: 3px;
    background: #1e293b;
    border-radius: 2px;
    transition: all 0.3s;
  }
  
  .hamburger-btn.open span:nth-child(1) {
    transform: rotate(45deg) translate(6px, 6px);
  }
  
  .hamburger-btn.open span:nth-child(2) {
    opacity: 0;
  }
  
  .hamburger-btn.open span:nth-child(3) {
    transform: rotate(-45deg) translate(8px, -8px);
  }
  
  .zone-item {
    padding: 0.875rem;
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 0.75rem;
    margin-bottom: 0.5rem;
    cursor: pointer;
    transition: all 0.2s;
  }
  
  .zone-item:hover {
    background: rgba(255, 255, 255, 0.1);
    transform: translateX(4px);
  }
  
  .zone-item.active {
    border-color: #3b82f6;
    background: rgba(59, 130, 246, 0.2);
  }
  
  .leaderboard-item {
    display: flex;
    align-items: center;
    gap: 0.875rem;
    padding: 0.875rem;
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 0.75rem;
    margin-bottom: 0.5rem;
    transition: all 0.2s;
  }
  
  .leaderboard-item:hover {
    background: rgba(255, 255, 255, 0.1);
    transform: translateX(4px);
  }
  
  .rank-badge {
    width: 36px;
    height: 36px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 700;
    font-size: 0.875rem;
  }
  
  .rank-1 { background: linear-gradient(135deg, #fbbf24, #f59e0b); }
  .rank-2 { background: linear-gradient(135deg, #94a3b8, #64748b); }
  .rank-3 { background: linear-gradient(135deg, #fb923c, #f97316); }
  
  @media (max-width: 768px) {
    .sidebar {
      width: 100%;
      transform: translateX(-100%);
    }
    
    .sidebar.open {
      transform: translateX(0);
    }
    
    .hamburger-btn {
      display: flex;
    }
    
    #map {
      width: 100% !important;
      margin-left: 0 !important;
    }
  }
  
  @media (min-width: 769px) {
    #map {
      margin-left: 420px;
      width: calc(100% - 420px) !important;
    }
  }
</style>
</head>
<body>
<button class="hamburger-btn" id="hamburgerBtn" onclick="toggleMobileMenu()">
  <span></span>
  <span></span>
  <span></span>
</button>

<div id="root"></div>

<script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
<script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
<script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
<script src="https://unpkg.com/@supabase/supabase-js@2"></script>
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBxqGzPnCxZNpH3Xopsk4VnwZOxVLjSQWc&libraries=places&callback=initGoogleMaps" async defer></script>

<script>
window.gm_authFailure = function() {
  alert('Google Maps authentication failed. Please check API key configuration.');
  console.error('Google Maps Auth Error');
};

window.initGoogleMaps = function() {
  console.log('Google Maps API loaded');
  window.googleMapsReady = true;
};

window.toggleMobileMenu = function() {
  const sidebar = document.querySelector('.sidebar');
  const hamburger = document.getElementById('hamburgerBtn');
  if (sidebar && hamburger) {
    sidebar.classList.toggle('open');
    hamburger.classList.toggle('open');
  }
};
</script>

<script type="text/babel">
const { useState, useEffect, useRef } = React;

const SUPABASE_URL = 'https://cytikhfyygkovnjtpsth.supabase.co';
const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImN5dGlraGZ5eWdrb3ZuanRwc3RoIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzQxMDc4NjYsImV4cCI6MjA0OTY4Mzg2Nn0.zrL0IqJ7rVwDbfipSFqHdKJKBpqZSJjlL5eX4IVhWJQ';
const GHL_API_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJsb2NhdGlvbl9pZCI6ImVuMmQ4Q2FxR0Q4YTNTRUNNSEY4eiIsImNvbXBhbnlfaWQiOiJPY3JQM2ljTW5tcTlXSkxLRkhvTSIsInZlcnNpb24iOjEsImlhdCI6MTczNDg0NjI5NDUzOCwic3ViIjoiSGZ5Y045M1RsN3VHckFQZ2l2MjQifQ.m7c5fHpJldhJLwp14cA0XOmRNgEbnGJy5ufQxCiujRA';
const GHL_LOCATION_ID = 'en2d8CaqGD8a3SEMVFHz';
const GHL_CALENDAR_URL = 'https://sea.refinedpainting.co/widget/booking/fIYuXbwwo4XQh3nyLxj8';
const ADMIN_USER_IDS = ['user-1760858671762', 'user-1760855853315'];

function RepZoneApp() {
  const [pins, setPins] = useState([]);
  const [zones, setZones] = useState([]);
  const [teamMembers, setTeamMembers] = useState([]);
  const [liveLocations, setLiveLocations] = useState([]);
  const [currentUser, setCurrentUser] = useState(null);
  const [currentLocation, setCurrentLocation] = useState(null);
  const [mode, setMode] = useState("drop-pin");
  const [status, setStatus] = useState("estimate");
  const [note, setNote] = useState("");
  const [activeTab, setActiveTab] = useState("controls");
  const [loading, setLoading] = useState(true);
  const [saving, setSaving] = useState(false);
  const [mapReady, setMapReady] = useState(false);
  const [isMobile, setIsMobile] = useState(window.innerWidth < 768);
  const [trackingEnabled, setTrackingEnabled] = useState(false);
  const [toastMessage, setToastMessage] = useState(null);
  const [geocoding, setGeocoding] = useState(false);
  const [showCustomerForm, setShowCustomerForm] = useState(false);
  const [customerName, setCustomerName] = useState('');
  const [customerPhone, setCustomerPhone] = useState('');
  const [customerEmail, setCustomerEmail] = useState('');
  const [customerNote, setCustomerNote] = useState('');
  const [showCalendarModal, setShowCalendarModal] = useState(false);
  const [calendarData, setCalendarData] = useState(null);
  const [pendingPinLocation, setPendingPinLocation] = useState(null);
  const [fdMode, setFdMode] = useState(false);
  const [selectedZone, setSelectedZone] = useState(null);
  const [activeZoneId, setActiveZoneId] = useState(null);
  const [showUserModal, setShowUserModal] = useState(false);
  const [newUserName, setNewUserName] = useState("");
  const [newUserRole, setNewUserRole] = useState("rep");
  const [leaderboardPeriod, setLeaderboardPeriod] = useState('week');
  const [filter, setFilter] = useState({ status: "all", userId: "all" });
  const [drawingZone, setDrawingZone] = useState(false);
  const [zonePoints, setZonePoints] = useState([]);

  const mapRef = useRef(null);
  const mapInstanceRef = useRef(null);
  const supabase = useRef(null);
  const locationWatchId = useRef(null);
  const locationUpdateInterval = useRef(null);
  const markersRef = useRef([]);
  const userMarkerRef = useRef(null);
  const searchBoxRef = useRef(null);
  const zonePolygonsRef = useRef([]);
  const drawingPolygonRef = useRef(null);

  const LEAD_TYPES = {
    estimate: { emoji: 'üí∞', label: 'Estimate (A)', color: '#10b981', value: 'estimate' },
    callback: { emoji: 'üìû', label: 'Callback (B)', color: '#f59e0b', value: 'callback' },
    not_interested: { emoji: 'üìã', label: 'Not Int (C)', color: '#64748b', value: 'not_interested' },
    flyer_drop: { emoji: 'üèòÔ∏è', label: 'Flyer (FD)', color: '#3b82f6', value: 'flyer_drop' }
  };

  useEffect(() => {
    console.log('RepZone initializing...');
    supabase.current = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
    
    const handleResize = () => setIsMobile(window.innerWidth < 768);
    window.addEventListener('resize', handleResize);
    
    // Set up global callback for Google Maps
    window.startRepZoneApp = () => {
      console.log('Google Maps ready, initializing map...');
      if (mapRef.current && !mapReady) {
        initializeMap();
      }
    };
    
    initializeApp();
    
    return () => {
      window.removeEventListener('resize', handleResize);
      if (locationWatchId.current) navigator.geolocation.clearWatch(locationWatchId.current);
      if (locationUpdateInterval.current) clearInterval(locationUpdateInterval.current);
    };
  }, []);

  useEffect(() => {
    if (mapReady && mapInstanceRef.current) {
      updateMarkers();
      updateZones();
    }
  }, [pins, zones, mapReady, filter]);

  useEffect(() => {
    if (!loading && window.googleMapsReady && mapRef.current && !mapReady) {
      console.log('Loading finished, initializing map now...');
      initializeMap();
    }
  }, [loading, mapReady]);

  const initializeApp = async () => {
    try {
      let userId = localStorage.getItem('repzone_user_id');
      
      // Load team members first
      await loadTeamMembers();
      
      if (!userId) {
        // Show user selection modal instead of prompt
        setLoading(false);
        setShowUserModal(true);
        return;
      }
      
      const { data: user } = await supabase.current
        .from('team_members')
        .select('*')
        .eq('id', userId)
        .single();
        
      if (user) {
        setCurrentUser(user);
      } else {
        localStorage.removeItem('repzone_user_id');
        setLoading(false);
        setShowUserModal(true);
        return;
      }
      
      await Promise.all([
        loadPins(),
        loadZones(),
        loadLiveLocations()
      ]);
      
      setLoading(false);
      
      if (window.googleMapsReady) {
        initializeMap();
      }
    } catch (error) {
      console.error('Initialization error:', error);
      setLoading(false);
      showToast('Error initializing app');
    }
  };

  const initializeMap = () => {
    console.log('Initializing map...', { mapRef: !!mapRef.current, google: !!window.google });
    if (!mapRef.current || !window.google) {
      console.error('Map ref or Google not ready');
      return;
    }
    
    try {
      const map = new window.google.maps.Map(mapRef.current, {
        center: { lat: 47.6062, lng: -122.3321 },
        zoom: isMobile ? 12 : 13,
        mapTypeControl: false,
        streetViewControl: false,
        fullscreenControl: false,
        styles: [
          { featureType: "poi", elementType: "labels", stylers: [{ visibility: "off" }] }
        ]
      });
      
      mapInstanceRef.current = map;
      
      map.addListener('click', (e) => {
        if (drawingZone) {
          addZonePoint(e.latLng.lat(), e.latLng.lng());
        } else if (mode === 'drop-pin') {
          handleMapClick(e.latLng.lat(), e.latLng.lng());
        }
      });
      
      console.log('Map initialized successfully');
      setMapReady(true);
      startLocationTracking();
    } catch (error) {
      console.error('Error initializing map:', error);
    }
  };

  const loadTeamMembers = async () => {
    const { data } = await supabase.current.from('team_members').select('*');
    if (data) setTeamMembers(data);
  };

  const loadPins = async () => {
    const { data } = await supabase.current
      .from('pins')
      .select('*')
      .order('created_at', { ascending: false });
    if (data) setPins(data);
  };

  const loadZones = async () => {
    const { data } = await supabase.current.from('zones').select('*');
    if (data) setZones(data);
  };

  const loadLiveLocations = async () => {
    const { data } = await supabase.current
      .from('live_locations')
      .select('*')
      .eq('is_active', true);
    if (data) setLiveLocations(data);
  };

  const startLocationTracking = () => {
    if (!navigator.geolocation) return;
    
    setTrackingEnabled(true);
    
    locationWatchId.current = navigator.geolocation.watchPosition(
      (position) => {
        const location = {
          lat: position.coords.latitude,
          lng: position.coords.longitude,
          accuracy: position.coords.accuracy
        };
        setCurrentLocation(location);
        updateUserMarker(location);
      },
      (error) => console.error('Location error:', error),
      { enableHighAccuracy: true, maximumAge: 10000, timeout: 5000 }
    );
    
    locationUpdateInterval.current = setInterval(updateLiveLocation, 30000);
  };

  const updateLiveLocation = async () => {
    if (!currentLocation || !currentUser) return;
    
    await supabase.current
      .from('live_locations')
      .upsert({
        team_member_id: currentUser.id,
        lat: currentLocation.lat,
        lng: currentLocation.lng,
        accuracy: currentLocation.accuracy,
        last_updated: new Date().toISOString(),
        is_active: true
      });
      
    loadLiveLocations();
  };

  const updateUserMarker = (location) => {
    if (!mapInstanceRef.current) return;
    
    if (userMarkerRef.current) {
      userMarkerRef.current.setMap(null);
    }
    
    const marker = new window.google.maps.Marker({
      position: { lat: location.lat, lng: location.lng },
      map: mapInstanceRef.current,
      icon: {
        path: window.google.maps.SymbolPath.CIRCLE,
        scale: 10,
        fillColor: currentUser?.color || '#3b82f6',
        fillOpacity: 1,
        strokeColor: 'white',
        strokeWeight: 3
      },
      title: 'You'
    });
    
    const circle = new window.google.maps.Circle({
      map: mapInstanceRef.current,
      center: { lat: location.lat, lng: location.lng },
      radius: location.accuracy,
      fillColor: currentUser?.color || '#3b82f6',
      fillOpacity: 0.1,
      strokeColor: currentUser?.color || '#3b82f6',
      strokeOpacity: 0.3,
      strokeWeight: 1
    });
    
    userMarkerRef.current = { marker, circle };
  };

  const handleMapClick = async (lat, lng) => {
    if (fdMode) {
      await dropPin(lat, lng, '', 'flyer_drop');
      return;
    }
    
    setPendingPinLocation({ lat, lng });
    setShowCustomerForm(true);
  };

  const dropPin = async (lat, lng, address, leadType) => {
    if (!currentUser || !currentLocation) {
      showToast('Location required');
      return;
    }
    
    setSaving(true);
    
    try {
      const distance = calculateDistance(
        currentLocation.lat,
        currentLocation.lng,
        lat,
        lng
      );
      
      let verificationStatus = 'verified';
      if (distance > 50 && distance <= 150) verificationStatus = 'questionable';
      else if (distance > 150) verificationStatus = 'suspicious';
      
      const pinData = {
        lat,
        lng,
        status: leadType,
        address: address || await geocodeLocation(lat, lng) || 'Address not found',
        rep_name: currentUser.name,
        team_member_id: currentUser.id,
        note,
        actual_lat: currentLocation.lat,
        actual_lng: currentLocation.lng,
        distance_from_pin: distance,
        verification_status: verificationStatus,
        created_at: new Date().toISOString()
      };
      
      const { data: newPin, error } = await supabase.current
        .from('pins')
        .insert([pinData])
        .select()
        .single();
        
      if (error) throw error;
      
      if (leadType !== 'flyer_drop' && leadType !== 'not_interested') {
        await createGHLContact({
          name: customerName,
          email: customerEmail,
          phone: customerPhone,
          address: pinData.address,
          leadType,
          distance
        });
      }
      
      loadPins();
      resetForm();
      showToast(`${LEAD_TYPES[leadType].label} dropped!`);
      
    } catch (error) {
      console.error('Error dropping pin:', error);
      showToast('Error dropping pin');
    } finally {
      setSaving(false);
    }
  };

  const createGHLContact = async (data) => {
    try {
      const response = await fetch(`https://services.leadconnectorhq.com/contacts/`, {
        method: 'POST',
        headers: {
          'Authorization': `Bearer ${GHL_API_KEY}`,
          'Content-Type': 'application/json',
          'Version': '2021-07-28'
        },
        body: JSON.stringify({
          locationId: GHL_LOCATION_ID,
          firstName: data.name.split(' ')[0],
          lastName: data.name.split(' ').slice(1).join(' ') || '',
          email: data.email,
          phone: data.phone,
          address1: data.address,
          tags: ['Door-to-Door', LEAD_TYPES[data.leadType].label, `GPS-${data.distance <= 50 ? 'Verified' : 'Unverified'}`],
          customFields: [
            { key: 'rep_name', value: currentUser.name },
            { key: 'lead_type', value: data.leadType },
            { key: 'gps_distance', value: data.distance.toFixed(1) }
          ]
        })
      });
      
      if (data.leadType === 'estimate') {
        setCalendarData({ name: data.name, email: data.email, phone: data.phone });
        setShowCalendarModal(true);
      }
      
    } catch (error) {
      console.error('GHL Error:', error);
    }
  };

  const geocodeLocation = async (lat, lng) => {
    setGeocoding(true);
    try {
      const geocoder = new window.google.maps.Geocoder();
      const result = await new Promise((resolve) => {
        geocoder.geocode({ location: { lat, lng } }, (results, status) => {
          resolve(status === 'OK' && results[0] ? results[0].formatted_address : null);
        });
      });
      return result;
    } catch (error) {
      console.error('Geocoding error:', error);
      return null;
    } finally {
      setGeocoding(false);
    }
  };

  const updateMarkers = () => {
    if (!mapInstanceRef.current) return;
    
    markersRef.current.forEach(m => m.setMap(null));
    markersRef.current = [];
    
    const filteredPins = pins.filter(pin => {
      if (filter.status !== 'all' && pin.status !== filter.status) return false;
      if (filter.userId !== 'all' && pin.team_member_id !== filter.userId) return false;
      return true;
    });
    
    filteredPins.forEach(pin => {
      const user = teamMembers.find(u => u.id === pin.team_member_id);
      const leadType = LEAD_TYPES[pin.status];
      
      let strokeColor = 'white';
      if (pin.verification_status === 'verified') strokeColor = '#10b981';
      else if (pin.verification_status === 'questionable') strokeColor = '#f59e0b';
      else if (pin.verification_status === 'suspicious') strokeColor = '#ef4444';
      
      const marker = new window.google.maps.Marker({
        position: { lat: pin.lat, lng: pin.lng },
        map: mapInstanceRef.current,
        icon: {
          path: window.google.maps.SymbolPath.CIRCLE,
          scale: 12,
          fillColor: leadType?.color || user?.color || '#64748b',
          fillOpacity: 1,
          strokeColor,
          strokeWeight: 4
        },
        title: `${leadType?.label || pin.status} - ${user?.name || 'Unknown'}`
      });
      
      const infoWindow = new window.google.maps.InfoWindow({
        content: `
          <div style="padding: 0.5rem; color: #1e293b;">
            <strong style="color: ${leadType?.color};">${leadType?.label || pin.status}</strong><br/>
            <strong>${user?.name || 'Unknown'}</strong><br/>
            ${pin.address || 'No address'}<br/>
            ${pin.note ? `<em>${pin.note}</em><br/>` : ''}
            <small>Distance: ${pin.distance_from_pin?.toFixed(1) || '0'}ft (${pin.verification_status})</small><br/>
            <small>${new Date(pin.created_at).toLocaleString()}</small>
          </div>
        `
      });
      
      marker.addListener('click', () => infoWindow.open(mapInstanceRef.current, marker));
      markersRef.current.push(marker);
    });
  };

  const updateZones = () => {
    if (!mapInstanceRef.current) return;
    
    zonePolygonsRef.current.forEach(p => p.setMap(null));
    zonePolygonsRef.current = [];
    
    zones.forEach(zone => {
      if (!zone.points || zone.points.length < 3) return;
      
      const polygon = new window.google.maps.Polygon({
        paths: zone.points,
        map: mapInstanceRef.current,
        fillColor: zone.color,
        fillOpacity: 0.2,
        strokeColor: zone.color,
        strokeWeight: 2,
        clickable: true
      });
      
      polygon.addListener('click', () => {
        setActiveZoneId(zone.id);
        const bounds = new window.google.maps.LatLngBounds();
        zone.points.forEach(p => bounds.extend(p));
        mapInstanceRef.current.fitBounds(bounds);
      });
      
      zonePolygonsRef.current.push(polygon);
    });
  };

  const startDrawingZone = () => {
    setDrawingZone(true);
    setZonePoints([]);
    showToast('Click on map to draw zone');
  };

  const addZonePoint = (lat, lng) => {
    const newPoints = [...zonePoints, { lat, lng }];
    setZonePoints(newPoints);
    
    if (drawingPolygonRef.current) {
      drawingPolygonRef.current.setMap(null);
    }
    
    if (newPoints.length > 1) {
      drawingPolygonRef.current = new window.google.maps.Polygon({
        paths: newPoints,
        map: mapInstanceRef.current,
        fillColor: '#3b82f6',
        fillOpacity: 0.2,
        strokeColor: '#3b82f6',
        strokeWeight: 2
      });
    }
  };

  const finishDrawingZone = async () => {
    if (zonePoints.length < 3) {
      showToast('Need at least 3 points');
      return;
    }
    
    const zoneName = prompt('Enter zone name:');
    if (!zoneName) return;
    
    const { error } = await supabase.current
      .from('zones')
      .insert([{
        name: zoneName,
        color: getRandomColor(),
        points: zonePoints,
        created_by: currentUser.id
      }]);
      
    if (error) {
      console.error('Error creating zone:', error);
      showToast('Error creating zone');
    } else {
      showToast('Zone created!');
      loadZones();
    }
    
    cancelDrawingZone();
  };

  const cancelDrawingZone = () => {
    setDrawingZone(false);
    setZonePoints([]);
    if (drawingPolygonRef.current) {
      drawingPolygonRef.current.setMap(null);
      drawingPolygonRef.current = null;
    }
  };

  const deleteZone = async (zoneId) => {
    if (!confirm('Delete this zone?')) return;
    
    const { error } = await supabase.current
      .from('zones')
      .delete()
      .eq('id', zoneId);
      
    if (error) {
      showToast('Error deleting zone');
    } else {
      showToast('Zone deleted');
      loadZones();
    }
  };

  const getStats = () => {
    const userPins = pins.filter(p => p.team_member_id === currentUser?.id);
    return {
      estimates: userPins.filter(p => p.status === 'estimate').length,
      callbacks: userPins.filter(p => p.status === 'callback').length,
      notInterested: userPins.filter(p => p.status === 'not_interested').length,
      flyers: userPins.filter(p => p.status === 'flyer_drop').length,
      total: userPins.length
    };
  };

  const getLeaderboard = () => {
    const now = new Date();
    let startDate;
    
    if (leaderboardPeriod === 'day') {
      startDate = new Date(now.getFullYear(), now.getMonth(), now.getDate());
    } else if (leaderboardPeriod === 'week') {
      startDate = new Date(now);
      startDate.setDate(now.getDate() - 7);
    } else {
      startDate = new Date(0);
    }
    
    const filteredPins = pins.filter(p => new Date(p.created_at) >= startDate);
    
    const stats = teamMembers.map(member => {
      const memberPins = filteredPins.filter(p => p.team_member_id === member.id);
      return {
        ...member,
        d2d: memberPins.filter(p => p.status !== 'flyer_drop').length,
        flyers: memberPins.filter(p => p.status === 'flyer_drop').length,
        total: memberPins.length
      };
    });
    
    return stats.sort((a, b) => b.total - a.total);
  };

  const resetForm = () => {
    setCustomerName('');
    setCustomerEmail('');
    setCustomerPhone('');
    setCustomerNote('');
    setNote('');
    setShowCustomerForm(false);
    setPendingPinLocation(null);
  };

  const showToast = (message) => {
    setToastMessage(message);
    setTimeout(() => setToastMessage(null), 3000);
  };

  const calculateDistance = (lat1, lon1, lat2, lon2) => {
    const R = 20902231;
    const dLat = (lat2 - lat1) * Math.PI / 180;
    const dLon = (lon2 - lon1) * Math.PI / 180;
    const a = Math.sin(dLat/2) * Math.sin(dLat/2) +
              Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) *
              Math.sin(dLon/2) * Math.sin(dLon/2);
    const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
    return R * c;
  };

  const getRandomColor = () => {
    const colors = ['#ef4444', '#f59e0b', '#10b981', '#3b82f6', '#8b5cf6', '#ec4899'];
    return colors[Math.floor(Math.random() * colors.length)];
  };

  const isAdmin = ADMIN_USER_IDS.includes(currentUser?.id);
  const stats = getStats();
  const leaderboard = getLeaderboard();

  if (loading) {
    return (
      <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'center', height: '100vh', background: '#0f172a' }}>
        <div className="spinner"></div>
      </div>
    );
  }

  return (
    <>
      <div className="sidebar">
        <div className="sidebar-content">
          <div style={{ marginBottom: '1.5rem' }}>
            <h1 style={{ fontSize: '1.875rem', fontWeight: '700', color: 'white', marginBottom: '0.25rem' }}>
              üè† RepZone Pro
            </h1>
            <p style={{ fontSize: '0.875rem', color: '#94a3b8' }}>Door Knocking Tracker</p>
          </div>

          {currentUser ? (
            <>
              <div className="user-badge">
                <div className="user-avatar" style={{ background: currentUser.color }}>
                  {currentUser.name[0].toUpperCase()}
                </div>
                <div style={{ flex: 1 }}>
                  <div style={{ fontWeight: '600', color: 'white' }}>{currentUser.name}</div>
                  <div style={{ fontSize: '0.75rem', color: '#94a3b8', textTransform: 'uppercase' }}>
                    {currentUser.role}
                  </div>
                </div>
                <button 
                  className="btn-secondary" 
                  style={{ padding: '0.5rem 1rem', fontSize: '0.75rem' }}
                  onClick={() => setShowUserModal(true)}
                >
                  Switch
                </button>
              </div>

              <div className="tab-nav">
                <div className={`tab ${activeTab === 'controls' ? 'active' : ''}`} onClick={() => setActiveTab('controls')}>
                  Controls
                </div>
                <div className={`tab ${activeTab === 'zones' ? 'active' : ''}`} onClick={() => setActiveTab('zones')}>
                  Zones
                </div>
                <div className={`tab ${activeTab === 'leaderboard' ? 'active' : ''}`} onClick={() => setActiveTab('leaderboard')}>
                  Stats
                </div>
              </div>
            </>
          ) : (
            <div className="card" style={{ textAlign: 'center', padding: '2rem' }}>
              <div style={{ fontSize: '3rem', marginBottom: '1rem' }}>üëã</div>
              <h3 style={{ color: 'white', fontSize: '1.25rem', fontWeight: '600', marginBottom: '0.5rem' }}>
                Welcome to RepZone Pro
              </h3>
              <p style={{ color: '#94a3b8', marginBottom: '1.5rem' }}>
                Select your account to get started
              </p>
              <button
                className="btn btn-primary"
                style={{ width: '100%' }}
                onClick={() => setShowUserModal(true)}
              >
                Select Account
              </button>
            </div>
          )}

          {currentUser && activeTab === 'controls' && (
            <>
              <div className="card">
                <h3 style={{ fontSize: '1rem', fontWeight: '600', color: 'white', marginBottom: '0.75rem' }}>
                  üéØ Lead Type
                </h3>
                <div className="lead-type-grid">
                  {Object.values(LEAD_TYPES).map(type => (
                    <div
                      key={type.value}
                      className={`lead-type-btn ${status === type.value ? 'active' : ''}`}
                      style={{ background: type.color, color: 'white' }}
                      onClick={() => setStatus(type.value)}
                    >
                      <span className="emoji">{type.emoji}</span>
                      <span className="label">{type.label}</span>
                    </div>
                  ))}
                </div>
                
                <input
                  className="input"
                  style={{ marginTop: '1rem' }}
                  placeholder="Note (gate code, dog, etc.)"
                  value={note}
                  onChange={(e) => setNote(e.target.value)}
                />
                
                <div style={{ marginTop: '1rem', display: 'flex', gap: '0.5rem' }}>
                  <button
                    className="btn btn-primary"
                    style={{ flex: 1 }}
                    onClick={() => setFdMode(!fdMode)}
                  >
                    {fdMode ? '‚úÖ FD Mode ON' : 'üèòÔ∏è Enable FD Mode'}
                  </button>
                </div>
              </div>

              <div className="card">
                <h3 style={{ fontSize: '1rem', fontWeight: '600', color: 'white', marginBottom: '1rem' }}>
                  üìä Quick Stats
                </h3>
                <div className="stat-grid">
                  <div className="stat-card">
                    <div className="stat-value" style={{ color: LEAD_TYPES.estimate.color }}>
                      {stats.estimates}
                    </div>
                    <div className="stat-label">Estimates</div>
                  </div>
                  <div className="stat-card">
                    <div className="stat-value" style={{ color: LEAD_TYPES.callback.color }}>
                      {stats.callbacks}
                    </div>
                    <div className="stat-label">Callbacks</div>
                  </div>
                  <div className="stat-card">
                    <div className="stat-value" style={{ color: LEAD_TYPES.flyer_drop.color }}>
                      {stats.flyers}
                    </div>
                    <div className="stat-label">Flyers</div>
                  </div>
                  <div className="stat-card">
                    <div className="stat-value">{stats.total}</div>
                    <div className="stat-label">Total</div>
                  </div>
                </div>
              </div>

              <div className="card">
                <h3 style={{ fontSize: '1rem', fontWeight: '600', color: 'white', marginBottom: '0.75rem' }}>
                  üéÆ Controls
                </h3>
                <div style={{ display: 'flex', flexDirection: 'column', gap: '0.5rem' }}>
                  <button
                    className={`btn ${trackingEnabled ? 'btn-primary' : 'btn-secondary'}`}
                    onClick={startLocationTracking}
                  >
                    {trackingEnabled ? '‚úÖ Tracking Active' : 'üìç Start Tracking'}
                  </button>
                  {currentLocation && (
                    <div style={{ fontSize: '0.75rem', color: '#94a3b8', textAlign: 'center' }}>
                      Accuracy: ¬±{currentLocation.accuracy?.toFixed(0)}ft
                    </div>
                  )}
                </div>
              </div>
            </>
          )}

          {currentUser && activeTab === 'zones' && (
            <>
              <div className="card">
                <h3 style={{ fontSize: '1rem', fontWeight: '600', color: 'white', marginBottom: '1rem' }}>
                  üó∫Ô∏è Zone Management
                </h3>
                
                {!drawingZone ? (
                  <button className="btn btn-primary" style={{ width: '100%' }} onClick={startDrawingZone}>
                    + Draw New Zone
                  </button>
                ) : (
                  <div style={{ display: 'flex', gap: '0.5rem' }}>
                    <button className="btn btn-primary" style={{ flex: 1 }} onClick={finishDrawingZone}>
                      ‚úÖ Finish ({zonePoints.length} points)
                    </button>
                    <button className="btn btn-secondary" onClick={cancelDrawingZone}>
                      ‚úñ
                    </button>
                  </div>
                )}
              </div>

              <div className="card">
                <h3 style={{ fontSize: '0.875rem', fontWeight: '600', color: 'white', marginBottom: '0.75rem' }}>
                  Active Zones ({zones.length})
                </h3>
                <div style={{ maxHeight: '300px', overflowY: 'auto' }}>
                  {zones.length === 0 ? (
                    <div style={{ textAlign: 'center', padding: '2rem', color: '#64748b' }}>
                      No zones yet. Draw one!
                    </div>
                  ) : (
                    zones.map(zone => (
                      <div key={zone.id} className={`zone-item ${activeZoneId === zone.id ? 'active' : ''}`}>
                        <div style={{ display: 'flex', alignItems: 'center', gap: '0.75rem' }}>
                          <div style={{ width: '12px', height: '12px', borderRadius: '50%', background: zone.color }}></div>
                          <div style={{ flex: 1 }}>
                            <div style={{ fontWeight: '600', color: 'white', fontSize: '0.9375rem' }}>{zone.name}</div>
                            <div style={{ fontSize: '0.75rem', color: '#64748b' }}>
                              {zone.points?.length || 0} points
                            </div>
                          </div>
                          {isAdmin && (
                            <button 
                              onClick={(e) => { e.stopPropagation(); deleteZone(zone.id); }}
                              style={{ padding: '0.25rem 0.5rem', fontSize: '0.75rem', background: '#ef4444', color: 'white', border: 'none', borderRadius: '0.375rem', cursor: 'pointer' }}
                            >
                              Delete
                            </button>
                          )}
                        </div>
                      </div>
                    ))
                  )}
                </div>
              </div>
            </>
          )}

          {currentUser && activeTab === 'leaderboard' && (
            <>
              <div className="card">
                <h3 style={{ fontSize: '1rem', fontWeight: '600', color: 'white', marginBottom: '1rem' }}>
                  üèÜ Leaderboard
                </h3>
                
                <div style={{ display: 'flex', gap: '0.5rem', marginBottom: '1rem' }}>
                  {['day', 'week', 'all'].map(period => (
                    <button
                      key={period}
                      className={`btn ${leaderboardPeriod === period ? 'btn-primary' : 'btn-secondary'}`}
                      style={{ flex: 1, padding: '0.5rem', fontSize: '0.75rem' }}
                      onClick={() => setLeaderboardPeriod(period)}
                    >
                      {period === 'day' ? 'Today' : period === 'week' ? 'Week' : 'All Time'}
                    </button>
                  ))}
                </div>

                <div style={{ maxHeight: '400px', overflowY: 'auto' }}>
                  {leaderboard.map((member, idx) => (
                    <div key={member.id} className="leaderboard-item">
                      <div className={`rank-badge ${idx < 3 ? `rank-${idx + 1}` : ''}`} style={idx >= 3 ? { background: '#334155', color: '#94a3b8' } : {}}>
                        {idx + 1}
                      </div>
                      <div style={{ width: '32px', height: '32px', borderRadius: '50%', background: member.color, display: 'flex', alignItems: 'center', justifyContent: 'center', color: 'white', fontWeight: '600', fontSize: '0.875rem' }}>
                        {member.name[0].toUpperCase()}
                      </div>
                      <div style={{ flex: 1 }}>
                        <div style={{ fontWeight: '600', color: 'white', fontSize: '0.9375rem' }}>{member.name}</div>
                        <div style={{ fontSize: '0.75rem', color: '#64748b' }}>
                          {member.d2d} D2D ‚Ä¢ {member.flyers} Flyers
                        </div>
                      </div>
                      <div style={{ textAlign: 'right' }}>
                        <div style={{ fontSize: '1.25rem', fontWeight: '700', color: 'white' }}>{member.total}</div>
                        <div style={{ fontSize: '0.625rem', color: '#64748b' }}>TOTAL</div>
                      </div>
                    </div>
                  ))}
                </div>
              </div>
            </>
          )}
        </div>
      </div>

      <div id="map" ref={mapRef}></div>

      {toastMessage && (
        <div className="toast">
          <div style={{ display: 'flex', alignItems: 'center', gap: '0.75rem' }}>
            <div style={{ fontSize: '1.5rem' }}>‚úÖ</div>
            <div style={{ fontWeight: '600', color: '#1e293b' }}>{toastMessage}</div>
          </div>
        </div>
      )}

      {showCustomerForm && (
        <div className="modal" onClick={() => setShowCustomerForm(false)}>
          <div className="modal-content" onClick={(e) => e.stopPropagation()}>
            <h2 style={{ fontSize: '1.5rem', fontWeight: '700', color: 'white', marginBottom: '1.5rem' }}>
              Customer Info
            </h2>
            
            <div style={{ display: 'flex', flexDirection: 'column', gap: '1rem' }}>
              <input
                className="input"
                placeholder="Customer Name *"
                value={customerName}
                onChange={(e) => setCustomerName(e.target.value)}
              />
              <input
                className="input"
                type="tel"
                placeholder="Phone Number *"
                value={customerPhone}
                onChange={(e) => setCustomerPhone(e.target.value)}
              />
              <input
                className="input"
                type="email"
                placeholder="Email"
                value={customerEmail}
                onChange={(e) => setCustomerEmail(e.target.value)}
              />
              <textarea
                className="input"
                placeholder="Additional notes..."
                value={customerNote}
                onChange={(e) => setCustomerNote(e.target.value)}
                rows={3}
              />
              
              <div style={{ display: 'flex', gap: '0.75rem', marginTop: '0.5rem' }}>
                <button
                  className="btn btn-secondary"
                  style={{ flex: 1 }}
                  onClick={() => setShowCustomerForm(false)}
                >
                  Cancel
                </button>
                <button
                  className="btn btn-primary"
                  style={{ flex: 1 }}
                  onClick={async () => {
                    if (!customerName || !customerPhone) {
                      showToast('Name and phone required');
                      return;
                    }
                    await dropPin(
                      pendingPinLocation.lat,
                      pendingPinLocation.lng,
                      '',
                      status
                    );
                  }}
                  disabled={saving || !customerName || !customerPhone}
                >
                  {saving ? 'Saving...' : 'Drop Pin'}
                </button>
              </div>
            </div>
          </div>
        </div>
      )}

      {showCalendarModal && (
        <div className="modal" onClick={() => setShowCalendarModal(false)}>
          <div className="modal-content" style={{ maxWidth: '700px' }} onClick={(e) => e.stopPropagation()}>
            <h2 style={{ fontSize: '1.5rem', fontWeight: '700', color: 'white', marginBottom: '1rem' }}>
              Book Estimate
            </h2>
            <iframe
              src={GHL_CALENDAR_URL}
              style={{ width: '100%', height: '600px', border: 'none', borderRadius: '1rem' }}
            />
            <button
              className="btn btn-secondary"
              style={{ width: '100%', marginTop: '1rem' }}
              onClick={() => setShowCalendarModal(false)}
            >
              Close
            </button>
          </div>
        </div>
      )}

      {showUserModal && (
        <div className="modal" onClick={() => !currentUser && showToast('Please select a user')}>
          <div className="modal-content" onClick={(e) => e.stopPropagation()}>
            <h2 style={{ fontSize: '1.5rem', fontWeight: '700', color: 'white', marginBottom: '1.5rem' }}>
              {currentUser ? 'Switch User' : 'Select Your Account'}
            </h2>
            
            {teamMembers.length > 0 ? (
              <>
                <div style={{ maxHeight: '400px', overflowY: 'auto', marginBottom: '1rem' }}>
                  {teamMembers.map(member => (
                    <div
                      key={member.id}
                      className="leaderboard-item"
                      style={{ cursor: 'pointer' }}
                      onClick={async () => {
                        localStorage.setItem('repzone_user_id', member.id);
                        setCurrentUser(member);
                        setShowUserModal(false);
                        
                        // Load data and initialize map
                        await Promise.all([
                          loadPins(),
                          loadZones(),
                          loadLiveLocations()
                        ]);
                        
                        if (window.googleMapsReady && mapRef.current && !mapReady) {
                          initializeMap();
                        }
                      }}
                    >
                      <div style={{ width: '40px', height: '40px', borderRadius: '50%', background: member.color, display: 'flex', alignItems: 'center', justifyContent: 'center', color: 'white', fontWeight: '700', fontSize: '1.125rem' }}>
                        {member.name[0].toUpperCase()}
                      </div>
                      <div style={{ flex: 1 }}>
                        <div style={{ fontWeight: '600', color: 'white', fontSize: '1rem' }}>{member.name}</div>
                        <div style={{ fontSize: '0.8125rem', color: '#64748b' }}>
                          {member.email || member.phone || member.role?.toUpperCase() || 'REP'}
                        </div>
                      </div>
                      {currentUser?.id === member.id && (
                        <div style={{ color: '#10b981', fontWeight: '600', fontSize: '0.875rem' }}>‚úì</div>
                      )}
                    </div>
                  ))}
                </div>
                
                {currentUser && (
                  <button
                    className="btn btn-secondary"
                    style={{ width: '100%' }}
                    onClick={() => setShowUserModal(false)}
                  >
                    Cancel
                  </button>
                )}
              </>
            ) : (
              <div style={{ textAlign: 'center', padding: '2rem', color: '#94a3b8' }}>
                <div style={{ fontSize: '3rem', marginBottom: '1rem' }}>üë•</div>
                <p>No team members found. Create one below.</p>
              </div>
            )}
          </div>
        </div>
      )}
    </>
  );
}

const root = ReactDOM.createRoot(document.getElementById('root'));
root.render(<RepZoneApp />);
</script>
</body>
</html>
